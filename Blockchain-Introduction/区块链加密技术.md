## 密码学简介

**密码学技术**

- 密码学技术是保障**网络信息安全**的核心技术
- 区块链大量使用了密码学的最新成果，特别是**身份认证和隐私保护**技术

**信息安全的四大安全属性**

- 机密性
  - 网络信息不被泄露给非授权的用户、实体或过程，或供其利用的特性
- 可认证性
  - 确保发送方和接收方声称的身份是真实有效的，方式冒充和重放
- 不可抵赖性
  - 所有参与者都不可能否认或抵赖曾经完成的操作和承诺
  - 利用信息源证据可以防止发信方不真实地否认已发送信息
  - 利用递交接收证据可以防止收信方否认已经接收的信息
- 完整性
  - 网络信息未经授权不能改变的特性
  - 网络信息在存储或传输过程中保持不被偶然或蓄意删除、修改、伪造等特性
  - 保持信息原样



公钥密码学：密码学的新方向诞生，意味着互联网时代**一到多的安全模式**出现



## 加解密算法

**加密技术的两个元素**

- 算法
  - 将普通信息或可理解的信息与密钥结合，产生不可理解的密文的步骤
- 密钥
  - 一种参数，是在明文转换为密文或将密文转换为明文的算法中输入的参数

### 对称加密算法

> 用**相同密钥**对原文进行加密和解密
>
> 优点：效率高，强度高
>
> 缺点：无法确保密钥被安全传递

**DES** (Data Encryption Standard) : 数据加密标准

- 速度快，适用于加密大量数据的场合，经典的分组加密算法
- 加密64位明文，密钥长度为64位（含8位校验位）
- 现在已经很容易被暴力破解

**3DES** (Triple DES) 

- 基于DES，对一块数据用三个不同的密钥进行三次加密，强度更高
- 现在也被认为不够安全

**AES** (Advanced Encryption Standard) :先进加密标准

- 分组加密算法
- 标准规范中，明文分组长度只能是128位，每个分组为16个字节，每个字节8位
- 密钥的分组长度可以用128位、192位或256位
- 密钥长度不同，加密轮数也不同
- AES优势在于处理速度快，整个过程可以用数学描述

### 非对称加密

> 公钥用于加密，私钥用于解密
>
> 公钥由私钥生成，私钥可以推导出公钥，但公钥无法推导出私钥
>
> 优点：解决了密钥传输中的安全性问题
>
> 缺点：计算效率低

**RSA加密算法**

- 支持变长密钥的公共密钥算法，要加密的文件块长度也可变
- 是分组加密算法，分组大小可根据密钥大小而改变
- 若加密数据不是分组大小整数倍，则需要填充
- RSA被认为是非常安全的，目前没有有效的办法可以破解RSA
- 计算速度比DES慢很多

**ECC(Elliptic Curves Cryptography)椭圆曲线密码算法**

- 基于对椭圆曲线上特定点进行特殊乘法逆运算难以计算的特性
- ECC系列算法一般被认为具备较高的安全性，但加解密计算过程往往比较费时



### 混合加密机制

> 对称加密：加解密效率高，加密强度高，但是在密钥传递上存在安全隐患
>
> 非对称加密：解决了对称加密需要安全传递密钥的问题，但是性能差

**混合加密**

- 先用非对称加密协商出一个临时的对称加密密钥，然后双方通过对称加密算法对所传递的大量数据进行快速加密处理

![image-20211212152046322](https://cdn.jsdelivr.net/gh/Collapssar/CDN@master/img/myblog/202112121520367.png)

> 1. 发送方使用接收方公钥加密对称密钥，发送给接收方
> 2. 接收方使用接收方私钥进行解密获得对称密钥
> 3. 发送方使用对称密钥加密要传送的数据，发送给接收方
> 4. 接收方使用获得的对称密钥对接收到的密文进行解密



### 加密算法应用

- 信息加密
  - 公钥加密，私钥解密，确保信息的安全性
- 数据签名
  - 私钥加密公钥解密，确保数字签名的归属性
- 登录认证
  - 私钥加密，公钥解密



## 哈希算法

哈希算法又被称为**指纹 **(Fingerprint)或**摘要** (Digest)算法

将一段任意长度数据经过计算转换位一段定长的数据

**哈希算法的特性**

- 正向快速
  - 无需强大的CPU/GPU，计算很快
- 不可逆性
  - 几乎无法通过Hash的结果推导出原文
- 无碰撞性
  - 几乎没有可能找到一个y使得y的Hash值等于x的哈希值
- 输入敏感
  - 原文哪怕一个bit的改变，输出的结果有很大不同

常见的哈希算法：MD4,MD5,SHA算法族等...

**应用场景**

- 数据校验
- 用户密钥存储
- 负载均衡
- 分布式缓存
- 唯一标识
- 数据副本一致性检查



## 数字签名

数字签名是只有信息的发送者才能产生的**别人无法伪造的一段数字串**，这段数字串同时也是对信息的**发送者发送信息真实性的一个有效证明**

一套数字签名通常定义两个互补的运算，一个用于**签名**，另一个用于**验证**

### 签名过程

- **对文件的Hash值**进行数字签名，可以认为与对文件本身进行数字签名等效
- 比对原文进行数字签名**速度更快**

![70363db7d4a788adb97ddba447e01c8](https://cdn.jsdelivr.net/gh/Collapssar/CDN@master/img/myblog/202112121546982.png)

--------------------------------------------------------------------------------------------------------------------------------------------------------------------

![18a98136c1b7a51d761990eba85270c](https://cdn.jsdelivr.net/gh/Collapssar/CDN@master/img/myblog/202112121546924.png)

### 盲签名

- 盲签名就是接收者在**不让签名者获取所签署消息具体内容**的情况下所采取的一种特殊的数字签名技术

**盲签名的性质**

- 不可伪造性
- 不可抵赖性
- 盲性
- 不可追踪性

**应用场景**

- 立遗嘱者需要公证处签名认证又不想让公证处知道遗嘱内容
- 消费者运用的电子现金要加上银行的数字签名才能生效，但是又需要维护消费者的匿名性
- 电子选举中选民提交的选票需要盖上选委会的数字签名，但是又要维护选民的匿名性

**盲签名的构造**

1. 盲化数据：通过引入随机数作为盲化因子，将原视待签名的数据进行盲化处理
2. 签名数据：利用私钥将盲化的数据进行签名
3. 解盲签名：利用盲化数据阶段的盲化因子将盲签名解盲
4. 验证签名：利用公钥验证签名。签名者不能确定自己何时签署的这条消息

![image-20211212161128309](https://cdn.jsdelivr.net/gh/Collapssar/CDN@master/img/myblog/202112121611387.png)



### 群签名

- 一个群体中的任意一个成员可以以匿名的方式代表整个整体对消息进行签名
- 群签名是可以公开验证的，而且可以只用单个群公钥来验证

**群签名流程**

1. 初始化
   1. 群管理者建立群资源，生成对应的群公钥和群私钥
   2. 群公钥对整个系统中的所有用户公开
2. 成员加入
   1. 在用户加入群的时候，群管理者颁发群证书给群成员
3. 签名
   1. 群成员利用获得的群证书签署文件，生成群签名
4. 验证  
   1. 利用群公钥仅可以验证所得群签名的正确性，但不能确定群中的正式签署者
5. 打开
   1. 群管理者利用私钥可以对群用户生成的群签名进行追踪，并暴露签署者身份



### 环签名

- 环签名其实就是实际的签名者**用其他可能签字者的公钥产生一个带有断口的环，然后用私钥将断口连成一个完整的环**
- 任何验证人**利用环成员的公钥**都可以验证一个环签名是否由某个可能的签名人生成

**环签名过程**

1. 初始化
   1. 签名者选定一个临时的签名者集合，包括签名者
2. 组建环
   1. 签名者利用自己的私钥和签名集合中其他人的公钥形成环
3. 签名
   1. 签名者利用自己的私钥和签名集合中其他人的公钥就可以独立的产生签名
4. 验签
   1. 使用这组公钥验证签名，可以验证确实是这组公钥中某个私钥的拥有者生成的环签名，但是却不知道是哪个公钥对应的私钥

**应用场景**

- 匿名举报
  在一个组织内，组织内的举报人可以使用其他成员的公钥联合自己的公私钥对一次举报进行签名，管理人会看到确实是组织内的人发起了这样的举报，但管理人不会知道具体是哪个成员发起的举报。如此，确保了举报的真实情况，隐藏了举报人，以避免了对举报人的一些不良后果如恶意报复等

- 匿名投票

- 匿名交易
  
  

### 多重签名

多重签名就是多个用户对同一个消息进行数字签名

**应用场景**

- 电子商务
- 财产分割
- 资金监管



## 高级加密技术

### 同态加密

- 同态加密除了能实现基本的加密操作之外，还能实现密文间的多种计算功能，即先计算后解密可等价于先解密后计算

### 零知识证明

- 零知识证明指证明者能够在不向验证者提供任何有用的信息的情况下，使验证者相信某个论断是正确的

### 不经意传输算法

- 是一种密码学协议。
- 解决的问题
  - 发送方将信息发送给接收方，但要保护双方的隐私
  - 发送方无法获知接收方最终获取了哪些信息
  - 接收方除了获知自己所需信息外，无法获得额外的信息